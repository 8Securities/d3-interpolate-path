<!DOCTYPE html>
<html>
  <head>
    <title>d3-interpolate-path</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="example.css" />
    <style>
      path {
        stroke: #0bb;
        stroke-width: 1.5px;
        fill: none;
      }

      .example {
        display: inline-block;
        margin-right: 10px;
        margin-bottom: 10px;
        border: 1px solid #ccc;
        padding: 8px;
        vertical-align: top;
      }

      .example h4 {
        margin-top: 0;
      }
    </style>
  </head>
  <body>
    <h1 class="main-header">d3-interpolate-path</h1>
    <p class="main-link"><a href="https://github.com/pbeshai/d3-interpolate-path">https://github.com/pbeshai/d3-interpolate-path</a></p>
    <div class='chart-container'></div>
    <p>
      <a href="https://github.com/pbeshai/d3-interpolate-path">Code on GitHub</a>
    </p>
    <h3>Visual Test Examples</h3>
    <div class='examples'>
    </div>
    <script src="//d3js.org/d3.v4.min.js"></script>
    <script src="d3-interpolate-path.js"></script>
    <script>
// helper to loop a path between two points
function loopPathBasic(path, dPath1, dPath2) {
  var looper = function() {
    path.attr('d', dPath1)
      .transition()
      .delay(1000)
      .duration(2000)
      .attr('d', dPath2)
      .transition()
      .delay(1000)
      .duration(2000)
      .attr('d', dPath1)
      .on('end', looper)
  }
  looper();
}

// helper to loop a path between two points using d3-interpolate-path
function loopPath(path, dPath1, dPath2) {
  var looper = function() {
    path.attr('d', dPath1)
      .transition()
      .delay(1000)
      .duration(2000)
      .attrTween('d', function () {
        return d3.interpolatePath(d3.select(this).attr('d'), dPath2);
      })
      .transition()
      .delay(1000)
      .duration(2000)
      .attrTween('d', function () {
        return d3.interpolatePath(d3.select(this).attr('d'), dPath1);
      })
      .on('end', looper)
  }
  looper();
}

var dataLine1 = [[0, 0], [200, 100], [400, 50], [500, 80]];
var dataLine2 = [[0, 100], [100, 50], [220, 80], [250, 0],
  [300, 20], [350, 30], [400, 100], [420, 10], [430, 90],
  [500, 40]];
var data = dataLine1.concat(dataLine2);

var width = 600;
var height = 600;
var lineHeight = 150;

var x = d3.scaleLinear()
    .domain(d3.extent(data, function (d) { return d[0]; }))
    .range([0, width]);

var y = d3
    .scaleLinear()
    .domain(d3.extent(data, function (d) { return d[1]; }))
    .range([lineHeight * 0.8, lineHeight * 0.5]);


var svg = d3.select('.chart-container').append('svg')
    .attr('width', width)
    .attr('height', height)

var line = d3.line()
    .curve(d3.curveLinear)
    .x(function (d) { return x(d[0]); })
    .y(function (d) { return y(d[1]); });


var g = svg.append('g');

g.append('path')
  .datum(dataLine1)
  .attr('d', line);

g.append('text')
  .attr('y', 25)
  .text('Line A');

g = svg.append('g')
  .attr('transform', 'translate(0 ' + lineHeight + ')');

loopPathBasic(g.append('path'), line(dataLine1), line(dataLine2));

g.append('text')
  .attr('y', 25)
  .text('d3 default interpolation');

g = svg.append('g')
  .attr('transform', 'translate(0 ' + lineHeight * 2 + ')')

loopPath(g.append('path'), line(dataLine1), line(dataLine2));

g.append('text')
  .attr('y', 25)
  .text('d3-interpolate-path');

g = svg.append('g')
  .attr('transform', 'translate(0 ' + lineHeight * 3 + ')')

g.append('path')
  .datum(dataLine2)
  .attr('d', line);

g.append('text')
  .attr('y', 25)
  .text('Line B');

  </script>
  <script src="examples.js"></script>
</body>
</html>